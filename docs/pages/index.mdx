---
layout: landing
---

import { HomePage } from 'vocs/components'
import { MetaBrowser } from '../components/MetaBrowser'
import { Codebox } from '../components/Codebox'


<HomePage.Root>
  <HomePage.Tagline>bunpkg æ˜¯å—åˆ° [unpkg](https://unpkg.com) å¯å‘è€Œå¼€å‘çš„ä¸€ä¸ª NPM CDN åŠ é€ŸæœåŠ¡å™¨, <br />
  è‡ªéƒ¨ç½²æ›´åŠ å‹å¥½, å¹¶æä¾›äº†é¢å¤–æœ¬åœ°æ–‡ä»¶ç¼“å­˜ç­‰åŠŸèƒ½</HomePage.Tagline>
  <HomePage.Tagline>bunpkg is an alternative for unpkg. <br />but friendly for self-host deploy and file cache supported </HomePage.Tagline>
</HomePage.Root>

- ğŸ’ æœ¬åœ°æ–‡ä»¶ç¼“å­˜: å‹ç¼©åŒ…(tgz) å’Œè®¿é—®è¿‡çš„æ–‡ä»¶ä¼šä½¿ç”¨ LRU ç­–ç•¥è¿›è¡Œç¼“å­˜, å¹¶ä½¿ç”¨ sqlite è¿›è¡ŒæŒä¹…åŒ–
  >  Local File Cache: tarboll and visited file LRU cache, powered by sqlite
- ğŸŒˆ æ”¯æŒç§æœ‰ä»“åº“: é€šè¿‡è‡ªå®šä¹‰çš„ `Authorization: Bearer ${TOKEN}` æ¥æ”¯æŒç§æœ‰ NPM ä»“åº“è®¤è¯
  >  Private Package Supported: Agent with npmAuthToken for private npm packages.
- ğŸš€ è¿è¡Œåœ¨ [Bun](https:bun.sh) ç¯å¢ƒä¸­, è¶…å¿«ä¹!
  >  Powered by [Bun](https://bun.sh)! is fast!


## æ¼”ç»ƒåœº LiveDemo

<MetaBrowser></MetaBrowser>

## ä½¿ç”¨ç¤ºä¾‹ Usages

### /npm/package@version/file

<Codebox title="åŠ è½½æ‰˜ç®¡åœ¨ npm ä¸Šçš„ä»»æ„æ–‡ä»¶">
https://bunpkg.com/npm/package@version/file
</Codebox>

<Codebox title="ä¸¾ä¸ªä¾‹å­">
https://bunpkg.com/npm/jquery@3.6.4/dist/jquery.min.js
</Codebox>

<Codebox title="ç‰ˆæœ¬ç®€å†™: ä½¿ç”¨ range ä»£æ›¿å…·ä½“çš„ç‰ˆæœ¬">
https://bunpkg.com/npm/jquery@3.6/dist/jquery.min.js
https://bunpkg.com/npm/jquery@3/dist/jquery.min.js
</Codebox>

<Codebox title="çœç•¥ç‰ˆæœ¬: å°†ä¼šè·å– @latest, ç”Ÿäº§ç¯å¢ƒä¸æ¨èä½¿ç”¨ ">
https://bunpkg.com/npm/jquery/dist/jquery.min.js
</Codebox>
<Codebox title="çœç•¥æ–‡ä»¶åç§°: ä¼šè·Ÿæ® package.json æŸ¥æ‰¾å£æ–‡ä»¶, ç”Ÿäº§ç¯å¢ƒä¸æ¨èä½¿ç”¨">
https://bunpkg.com/npm/jquery
</Codebox>

### /meta/package@version
è·å–åŒ…çš„æ–‡ä»¶åˆ—è¡¨å’Œå¯¹åº”ç‰ˆæœ¬çš„ package.json

<Codebox title="ä¸¾ä¸ªä¾‹å­">
https://bunpkg.com/meta/jquery@3.6.4
https://bunpkg.com/meta/jquery@3
https://bunpkg.com/meta/jquery
</Codebox>

### /esm/package@version/file

!IMOPRTANT è¿™æ˜¯ä¸€ä¸ªéå¸¸å®éªŒæ€§çš„åŠŸèƒ½ï¼Œé¿å…åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨

å¦‚æœä¸æ˜¯ js ä»£ç ï¼Œ å°†ä¼šå›é€€åˆ° npm ç‰ˆæœ¬

<Codebox title="ä½¿ç”¨ ESM æ ¼å¼åŠ è½½æ‰˜ç®¡åœ¨ npm ä¸Šçš„æ–‡ä»¶">
https://bunpkg.com/esm/package@version/file
</Codebox>

<Codebox title="ä¸¾ä¸ªä¾‹å­">
https://bunpkg.com/esm/ofetch@1.3.3/dist/index.mjs
</Codebox>

<Codebox title="ç‰ˆæœ¬ç®€å†™: ä½¿ç”¨ range ä»£æ›¿å…·ä½“çš„ç‰ˆæœ¬">
https://bunpkg.com/esm/ofetch@1.3/dist/index.mjs
https://bunpkg.com/esm/ofetch@1/dist/index.mjs
</Codebox>

<Codebox title="çœç•¥ç‰ˆæœ¬: å°†ä¼šè·å– @latest, ç”Ÿäº§ç¯å¢ƒä¸æ¨èä½¿ç”¨ ">
https://bunpkg.com/esm/ofetch/dist/index.mjs
</Codebox>

<Codebox title="çœç•¥æ–‡ä»¶åç§°: ä¼šè·Ÿæ® package.json æŸ¥æ‰¾å£æ–‡ä»¶, ç”Ÿäº§ç¯å¢ƒä¸æ¨èä½¿ç”¨">
https://bunpkg.com/esm/ofetch
</Codebox>


### è¯·æ±‚å‚æ•° Query Parameters
`?purge`

åˆ é™¤å½“å‰ url è·¯å¾„çš„ç¼“å­˜
<Codebox title="ä¸¾ä¸ªä¾‹å­">
https://bunpkg.com/esm/ofetch@1.3.3/dist/index.mjs?purge
</Codebox>


## ä¸ UNPKG çš„å¯¹æ¯”

| feture                                                                                          | bunpkg                                                                 | unpkg    |
| ----------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------- | -------- |
| 302 supported, example [npmmirror.com](https://registry.npmmirror.com/react/-/react-18.2.0.tgz) | âœ…                                                                     | ğŸš«       |
| Local File Cache                                                                                 | âœ… does nginx better, aha?                                             | ğŸš«       |
| private Authorization header                                                                    | âœ…                                                                     | ğŸš«       |
| esm                                                                                             | âœ… by [Bun.Transpiler](https://bun.sh/docs/api/transpiler#scanimports) | âœ… babel |


### HTTP ç¼“å­˜è¡¨ç° HTTP Cache Behavior

CDNæ ¹æ®åŒ…å«npmåŒ…ç‰ˆæœ¬çš„æ°¸ä¹…URLç¼“å­˜æ–‡ä»¶ã€‚è¿™æ˜¯å› ä¸ºnpmä¸å…è®¸åŒ…ä½œè€…è¦†ç›–å·²ç»ä»¥ç›¸åŒç‰ˆæœ¬å·å‘å¸ƒçš„ä¸åŒåŒ…ã€‚

> The CDN caches files based on their permanent URL, which includes the npm package version. This works because npm does not allow package authors to overwrite a package that has already been published with a different one at the same version number.

æµè§ˆå™¨è¢«æŒ‡ç¤ºï¼ˆé€šè¿‡Cache-Controlæ ‡å¤´ï¼‰æ— é™æœŸï¼ˆ1å¹´ï¼‰ç¼“å­˜èµ„äº§ã€‚

> Browsers are instructed (via the Cache-Control header) to cache assets indefinitely (1 year).

æœªæŒ‡å®šåŒ…ç‰ˆæœ¬å·çš„URLä¼šé‡å®šå‘åˆ°æŒ‡å®šåŒ…ç‰ˆæœ¬å·çš„URLã€‚å¦‚æœæœªæŒ‡å®šç‰ˆæœ¬ï¼Œè¿™æ˜¯æœ€æ–°ç‰ˆæœ¬ï¼Œå¦‚æœç»™å‡ºäº†semverç‰ˆæœ¬ï¼Œåˆ™æ˜¯æœ€å¤§æ»¡æ„ç‰ˆæœ¬ã€‚é‡å®šå‘åœ¨CDNä¸­ç¼“å­˜10åˆ†é’Ÿï¼Œåœ¨æµè§ˆå™¨ä¸­ç¼“å­˜1åˆ†é’Ÿã€‚

> URLs that do not specify a package version number redirect to one that does. This is the latest version when no version is specified, or the maxSatisfying version when a semver version is given. Redirects are cached for 10 minutes at the CDN, 1 minute in browsers.
 
å¦‚æœæ‚¨å¸Œæœ›ç”¨æˆ·åœ¨æ‚¨å‰ªåˆ‡æ–°ç‰ˆæœ¬æ—¶èƒ½å¤Ÿä½¿ç”¨æœ€æ–°ç‰ˆæœ¬ï¼Œæœ€å¥½çš„ç­–ç•¥æ˜¯å°†ç‰ˆæœ¬å·ç›´æ¥æ”¾åœ¨æ‚¨çš„å®‰è£…è¯´æ˜ä¸­çš„URLä¸­ã€‚è¿™ä¹Ÿå°†æ›´å¿«åœ°åŠ è½½ï¼Œå› ä¸ºæˆ‘ä»¬ä¸å¿…è§£ææœ€æ–°ç‰ˆæœ¬å¹¶é‡å®šå‘å®ƒä»¬ã€‚
> If you want users to be able to use the latest version when you cut a new release, the best policy is to put the version number in the URL directly in your installation instructions. This will also load more quickly because we won't have to resolve the latest version and redirect them.

### ç£ç›˜ç¼“å­˜è¡¨ç° Disk Cache Behavior

ä½¿ç”¨ CACHE_DIR=./cache æˆ–é‡æ–°æ˜ å°„docker volumns /cache æ¥è§‚å¯Ÿtarbollå’Œæ–‡ä»¶ç¼“å­˜ï¼›sqliteçš„æ–‡ä»¶ç¼“å­˜ç®¡ç†å™¨ï¼Œä½¿ç”¨LRUç®—æ³•ï¼›

> Use `CACHE_DIR=./cache` or remap docker volumns `/cache` to watch how tarboll and file cache; File Cache Manager by sqlite, with LRU algorithm; 

tarbollå’Œæ–‡ä»¶å¯¹åŠå…±äº«çš„é»˜è®¤é™åˆ¶ä¸º 4Gib ã€‚æ‚¨å¯ä»¥é€šè¿‡é…ç½®æ›´æ”¹å®ƒ

> Default limit is `4Gib` for tarboll and files shared. Your Can change it by Config 

## é…ç½®é¡¹  Config

- .env

é»˜è®¤å€¼
```bash
PORT=4567
# HOST=0.0.0.0
# CORS_ORIGIN=*
CACHE_DIR=./.cache
# CACHE_MAX_SIZE=4
NPM_REGISTRY=https://registry.npmmirror.com/
ESM_ORIGIN=https://bunpkg.com
# NPM_MAX_TGZ_SIZE=100
# NPM_AUTH_TOKEN=
# JWT_SECRET=
```

- bun.config.ts

```ts
import path from "node:path";
import { cors } from "@elysiajs/cors";

export const BunPkgConfig = {
  /** æœåŠ¡å™¨ç›¸å…³ */
  server: {
    /**
     * ç«¯å£å·
     * @default process.env.PORT || 4567
     */
    port: 4567,
    /**
     * ä¸»æœºå
     * @default process.env.HOST || '0.0.0.0'
     */
    // host: "0.0.0.0",
    /**
     * è·¨åŸŸé…ç½®
     * @default {origin:  process.env.CORS_ORIGIN } || Paramaters<typeof cors[0]>
     * @docuemnt see more https://elysiajs.com/plugins/cors.html#config
     */
    cors: {
      origin: "*",
    },
  },
  /** ç¼“å­˜é…ç½®  */
  cache: {
    /**
     * ç¼“å­˜ç¡¬ç›˜å ç”¨ç©ºé—´æœ€å¤§å€¼ (Gib)
     * @default process.env.CACHE_MAX_SIZE || 4
     */
    maxSize: 4,
    /**
     * ç£ç›˜ç¼“å­˜ç›®å½•ä½ç½®
     * @default process.env.CACHE_DIR || '/cache'
     */
    dir: "/cache",
  },
  /** NPM é…ç½® */
  npm: {
    /**
     * ä¸Šæ¸¸ NPM æºåœ°å€
     * @default process.env.NPM_REGISTRY || 'https://registry.npmjs.org/'
     */
    registry: "https://registry.npmjs.org/",
    /**
     * ç§æœ‰ npm è®¤è¯å¤´
     * Authorization: Bearer ${authToken}
     */
    // authToken: "",
    /**
     * æ”¯æŒæœ€å¤§ npm tgz å‹ç¼©åŒ…å°ºå¯¸ (mib)
     * @default 100 (Mib)
     * @default process.env.NPM_MAX_TGZ_SIZE || 100
     **/
    maxTgzSize: 100,
  },
  esm: {
    /**
     * ESM å‰ç¼€é…ç½®
     * @default process.env.ESM_ORIGIN
     */
    origin: "",
  },
  /**
   * æ˜¯å¦å¼€å¯ JWT è®¤è¯, åªæœ‰æœ‰å½“å‰é…ç½®é¡¹å¹¶æ·»åŠ äº† secret çš„æƒ…å†µä¸‹æ‰ä¼šå¼€å¯
   *  seemore https://elysiajs.com/plugins/jwt.html
   */
  jwt: {
    //   /**
    //    * è®¤è¯å¯†é’¥
    //    * @default process.env.JWT_SECRET
    //    **/
    //   secret: "",
  },
};

```


## docker

```bash
docker run -i -t -p 4567:4567 chaogpt/bunpkg
docker run --env-file .env \
  -i -t -p 4567:4567 \
  -v /cache:./cache \
  -v bunpkg.config.ts:/app/bunpkg.config.ts chaogpt/bunpkg 
```

## Roadmap

- [x] Persistence Cache (by sqlite)
- [x] Browser UI
- [] Live Config Manager
- [] Data Statistics

## Dev

```bash
bun dev
# then
# open http://localhost:4567
```

## Powered by

- [Elysia](https://elysiajs.com/)
- [bun.sh](https://bun.sh/)

